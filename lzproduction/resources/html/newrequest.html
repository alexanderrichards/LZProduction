<!DOCTYPE html>
<html>
<head>
	<!-- Add jQuery library using Google CDN (Content Delivery Network)-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css">
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>
	<!-- TiTaToggle CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/titatoggle/1.2.11/titatoggle-dist-min.css">
	<script>
$(document).ready(function() {

  $(".toggle").change(function(){
    $(".togglable[toggle~='" + this.id + "']").prop("disabled", !this.checked);
    $("select[toggle='" + this.id + "']").selectpicker("refresh");
    if (!this.checked){
      $(".togglable[toggleoff~='" + this.id + "']").prop("disabled", true);    
    }
    else if (this.checked){
      $(".togglable[toggleon~='" + this.id + "']").prop("disabled", false);    
    }
  });

  $.ajax({url: "/appversion/SolidSim/",
          type: "GET",
          success: function(result) {
                     $("#solidsim_version").html(result);
                     $("#solidsim_version").selectpicker("refresh");
                   }
  });

  $.ajax({url: "/appversion/saffron2/",
          type: "GET",
          success: function(result) {
                     $("#saffron2_ro_version").html(result);
                     $("#saffron2_ro_version").selectpicker("refresh");
                   }
  });

  $("#solidsim_version").change(function() {
    var solidsim_macro = $("#solidsim_macro");
    $.ajax({url: "/appversion/SolidSim/" + $("#solidsim_version option:selected").text() + "/solid_g4_sim/input_macros",
            type: "GET",
            success: function(result) {
                       solidsim_macro.html(result);
                       solidsim_macro.selectpicker("refresh");
                     }
            });
    });

  $("form").submit(function(event){
    // stop form submitting normally
    // could just let it submit normally if didn't need asynchronous ajax functionality
    event.preventDefault();

    parent.$.fancybox.close();
    $.ajax({url: this.action,  // this is the javascript this not JQuery object $(this)
            type: this.method,
            data: JSON.parse(JSON.stringify($(this).serializeArray())),
            success: function(result){
		       parent.$("#tableBody").DataTable().ajax.reload();
		       parent.bootstrap_alert("Success!", "Request added", "alert-success");
                       // by iteself, $ = jQuery.
                       // i.e. could use in the html onclick="parent.jQuery.fancybox.close();"
                    }
    });

  });

});
</script>
	<style>
  .macro-selection {width: 100%;
                    overflow-x:auto; 
                    overflow-y:auto;
                    overflow: -moz-scrollbars-horizontal;}
  .required { color: red;
              font-weight: bold;
            }
</style>
</head>
<body>
<div class="container">
	<div class="panel panel-primary">
		<div class="panel-heading">
			<h3 class="panel-title">New Request Form</h3>
		</div>
		<div class="panel-body">
			<form action="/api" method="POST">

				<!-- Application Setup -->
				<br>
				<fieldset>
					<legend>Solid Job Setup</legend>
					<nav>
						<!-- Tabs -->
						<ul class="nav nav-tabs">
							<li role="presentation" class="active"><a href="#simulation" role="tab" data-toggle="tab">Simulation</a></li>
							<li role="presentation"><a href="#ro" role="tab" data-toggle="tab">RO</a></li>
							<li role="presentation"><a href="#analysis" role="tab" data-toggle="tab">Analysis</a></li>
						</ul>

						<!-- Tab Content -->
						<!-- Simulation -->
						<!-- ---------- -->
						<div class="tab-content">
							<div role="tabpanel" class="tab-pane fade in active" id="simulation">
								<div class="checkbox checkbox-slider-info checkbox-slider--b">
									<label>
										<input type="checkbox" class="toggle" id="sim_toggle" checked><span></span>
									</label>
									<span class="glyphicon glyphicon-off text-primary"></span> Off/On
								</div>
								<div class="row">
									<div class="col-xs-6">
										<label for="solidsim_version">Select SolidSim Version:</label>
										<div class="input-group">
											<select id="solidsim_version" name="solidsim_version" class="selectpicker form-control togglable" toggle="sim_toggle" data-live-search="true" data-live-search-style="startsWith" data-size="10" data-width="180px" data-dropup-auto="false" data-live-search-placeholder="Search..." title="SolidSim Version" required>
											</select>
										</div>
									</div>
									<div class="col-xs-6">
										<label for="solidsim_nevents">NEvents:</label>
										<div class="input-group">
											<input id="solidsim_nevents" name="solidsim_nevents" placeholder="Number of events" class="form-control togglable" toggle="sim_toggle" type="text" required>
										</div>
									</div>
								</div>
								<br>
								<div class="row">
									<div class="col-xs-6">
										<label for="solidsim_macro">SolidSim Macro:</label>
										<div class="input-group macro-selection">
											<select id="solidsim_macro"  name="solidsim_macro", class="selectpicker form-control togglable" toggle="sim_toggle" data-size="6" width="100%" data-selected-text-format="count > 1" data-live-search="true" data-dropup-auto="false" data-live-search-placeholder="Search..." title="Macros" multiple required></select>
										</div>
									</div>

									<div class="col-xs-6">
										<label for="solidsim_inputfiletype">SolidSim Input File Type:</label>
										<div class="input-group">
											<span class="input-group-addon" id="basic-addon1">
											    <input type="checkbox" class="toggle togglable" toggle="sim_toggle" id="solidsim_inputfiletype_toggle">
											</span>

											<select id="solidsim_inputfiletype" name="solidsim_inputfiletype" class="selectpicker form-control togglable" toggleoff="sim_toggle" toggle="solidsim_inputfiletype_toggle" data-live-search="true" data-live-search-style="startsWith" data-size="10" data-width="100%" data-dropup-auto="false" data-live-search-placeholder="Search..." title="SolidSim input file type" required disabled>
												<option>atm-N</option>
												<option>Muon</option>
												<option>Bipo</option>
											</select>
<!--											<input id="solidsim_inputfile_lfn" name="solidsim_inputfile_lfn" toggleoff="sim_toggle" toggle="solidsim_inputfile_lfn_toggle" type="text" class="form-control togglable" placeholder="SolidSim input file LFN" aria-describedby="basic-addon1" required disabled>-->
										</div>
									</div>
								</div>
								<br>
								<div class="row">
									<div class="col-xs-6">
										<label for="solidsim_output_lfn">SolidSim Output LFN:</label>
										<div class="input-group">
											<input id="solidsim_output_lfn" name="solidsim_output_lfn" toggle="sim_toggle" type="text" class="form-ontrol togglable" placeholder="SolidSim output LFN" aria-describedby="basic-addon1" required>
										</div>
									</div>
								</div>
							</div>

							<!-- RO -->
							<!-- --------- -->
							<div role="tabpanel" class="tab-pane fade" id="ro">
								<div class="checkbox checkbox-slider-info checkbox-slider--b">
									<label>
										<input type="checkbox" class="toggle" id="ro_toggle"><span></span>
									</label>
									<span class="glyphicon glyphicon-off text-primary"></span> Off/On
								</div>
								<div class="row">
									<div class="col-xs-6">
										<label for="saffron2_ro_version">Select Saffron2 RO Version:</label>
										<div class="input-group">
											<select id="saffron2_ro_version" name="saffron2_ro_version" class="selectpicker form-control togglable" toggle="ro_toggle" data-live-search="true" data-live-search-style="startsWith" data-size="10" data-width="180px" data-dropup-auto="false" data-live-search-placeholder="Search..." title="Saffron2 RO Version" required disabled>
											</select>
										</div>
									</div>
									<div class="col-xs-6">
										<label for="saffron2_output_lfn">Saffron2 RO Output LFN:</label>
										<div class="input-group">
											<input id="saffron2_output_lfn" name="saffron2_output_lfn" toggle="ro_toggle" type="text" class="form-ontrol togglable" placeholder="Saffron2 RO output LFN" aria-describedby="basic-addon1" required disabled>
										</div>
									</div>
								</div>
							</div>

							<!-- Analysis -->
							<!-- --------- -->
							<div role="tabpanel" class="tab-pane fade" id="analysis">
								<div class="checkbox checkbox-slider-info checkbox-slider--b">
									<label>
										<input type="checkbox" class="toggle" id="reduction_toggle"><span></span>
									</label>
									<span class="glyphicon glyphicon-off text-primary"></span> Off/On
								</div>
								<div class="row">
									<div class="col-xs-12">
										<h4>Coming soon...</h4>
									</div>
								</div>
							</div>
						</div>
					</nav>
				</fieldset>



				<br>
				<button type="submit" class="btn btn-primary">
					<span class="glyphicon glyphicon-send"></span> Submit
				</button>

			</form>
		</div>
	</div>
</div>
</body>
</html>
